<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Hello!</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- import the webpage's stylesheet -->
    <link rel="stylesheet" href="/style.css" />
  </head>
  <body>
    <h1>
      Information Form
    </h1>
    <br />
    <form id="frm1">
      Name
      <input type="Text" name="name" style="width:300px;" id="name"/><br/><br/>
      Age
      <input type="Text" name="age" style="width:300px;" id="age"/><br/><br/>
      Language
      <input type="Text" name="language" style="width:300px;" id="language" /><br /><br/>
      Choice of Destination
      <input type="Text" name="destination" style="width:300px;" id="destination" /><br /><br/>
      Date
      <input type="Text" name="date" style="width:300px;" id="date"/><br /><br/>
      Days Available
      <input type="Text" name="availability" style="width:300px;" id="availability"/><br /><br/>
      Form ID
      <input type="Text" name="form_id" style="width:300px;" id="form_id"/><br /><br/>
    </form>

    <button type="submit" onclick="javascript:callAddPerson('/add_person')" name="btnSubmit">
      Submit
    </button>

    <button type="submit" onclick="callMatchPerson('/match_people')" name="btnMatchPerson">
        Click to Find Match
    </button>

    <script>
            function callWebAPI(url, parameters, func) {
                return fetch(url, {
                    method: "POST",
                    body: JSON.stringify(parameters),
                    headers: {
                    "Content-Type": "application/json"
                    }
                })
                    .then(res => res.json())
                    .then(response => func(JSON.stringify(response)))
                    .catch(error => console.error("Error:", error));
                }

            function callBack(resp) {
              console.log(resp);
            }

            function callAddPerson(url) {
                var name = document.getElementById("name").value;
                var age = document.getElementById("age").value;
                var language = document.getElementById("language").value;
                var destination = document.getElementById("destination").value;
                var date = document.getElementById("date").value;
                var availability = document.getElementById("availability").value;
                var form_id = document.getElementById('form_id').value;

                //construct parameter object according to API Documentation.
                var parameters = { Name: name, Age: age, Language: language, Destination: destination, Date_: date, Availability: availability, Form_Id: form_id };
                alert(JSON.stringify(parameters)); //debugging message

                callWebAPI(url, parameters, callBack); //call the API
            }

            function callMatchPerson(url) {
                // name required to find his details and compare to others in database
                var name = document.getElementById('name').value;
                
                var parameters = { Name: name };    
                alert(JSON.stringify(parameters)); //debugging message

                callWebAPI(url, parameters, callBack); //call the API 
            }
    </script>
  </body>
</html>
